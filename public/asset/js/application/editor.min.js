var EditorApp=angular.module("EditorApp",["ngRoute","ngResource","pgInterceptors","pgDirectives","pgFilters"]);EditorApp.config([function(){}]),EditorApp.factory("ThemesResource",["$resource","$http",function(e){var o={query:{method:"GET",isArray:!0,cache:!0}},t=e("xhr/themes/:themeId",{themeId:"@id"},o);return t.categories=e("xhr/themes/categories/:categoryId",{categoryId:"@id"},{query:{method:"GET",isArray:!0,cache:!0}}),t.forPage=function(e){return t.query({page_id:e})},t}]),EditorApp.factory("PageResource",["$resource",function(e){var o={get:{method:"GET",cache:!1},posts:{method:"GET",isArray:!0,params:{resource:"posts"},cache:!0},feeds:{method:"GET",isArray:!0,params:{resource:"feeds"},cache:!0},albums:{method:"GET",isArray:!0,params:{resource:"albums"},cache:!0},photos:{method:"GET",isArray:!0,params:{resource:"photos"},cache:!0},events:{method:"GET",isArray:!0,params:{resource:"events"},cache:!0},updateSubdomain:{method:"POST",params:{resource:"subdomain"}},updateDomain:{method:"POST",params:{resource:"domain"}},update:{method:"POST"}};return e("xhr/sites/:id/:resource/:resource_id",{id:PageWeb.editor.id,resource:"@id",resource_id:"@id"},o)}]),EditorApp.factory("UserResource",["$resource",function(e){var o={sites:{method:"GET",isArray:!0,cache:!0,params:{resource:"sites"}}},t=e("xhr/users/me/:resource",{resource:"@id"},o);return t}]),EditorApp.filter("themesInCategory",function(){return function(e,o){var t=o?[]:e;return o&&angular.forEach(e,function(e){o==e.category_id&&t.push(e)},t),t}}),EditorApp.controller("MainCtrl",["$scope",function(e){e.editor=PageWeb.editor,e.domainType="custom",e.panel={window:null,opened:!0},e.panel.previous=e.panel,e.extendedPanel={},e.reloadPreview=function(){document.getElementById("editor-preview-frame").contentWindow.location.reload(!0)},e.togglePanel=function(o){o?e.panel=e.panel.window==o&&e.panel.opened?{window:null,opened:!1}:{window:o,opened:!0}:e.panel.opened?e.panel={window:null,opened:!1}:(e.panel=e.panel.previous,e.panel.opened=!0),e.extendedPanel={}},e.toggleExtendedPanel=function(o,t){var r=o+"-"+t;e.extendedPanel.previous=e.extendedPanel,e.extendedPanel={previous:e.extendedPanel,parent:o,name:t,window:e.extendedPanel.previous.window==r?null:r}}}]),EditorApp.controller("HeaderCtrl",["$scope","UserResource",function(e,o){e.sites=o.sites()}]),EditorApp.controller("ToolboxCtrl",["$scope",function(){}]),EditorApp.controller("PanelCtrl",["$scope",function(){}]),EditorApp.controller("ExtendedPanelCtrl",["$scope",function(){}]),EditorApp.controller("PreviewCtrl",["$scope",function(){}]),EditorApp.controller("ThemeWindowCtrl",["$scope","ThemesResource","PageResource","$location",function(e,o,t,r){e.themes=o.query(),e.categories=o.categories.query(),e.themeId=e.editor.site.theme_id,e.themes.$promise.then(function(){angular.forEach(e.themes,function(o,t){e.themes[t].url=http_replace_query(r.absUrl(),{theme:o.name})})}),e.chooseTheme=function(o){return t.update({id:e.editor.site.id},{theme_id:o.id}).$promise.then(function(){e.editor.site.theme_id=e.themeId=o.id,e.reloadPreview()})}}]),EditorApp.controller("SettingWindowCtrl",["$scope","$http","PageResource",function(e,o,t){e.subdomain=e.editor.site.subdomain,e.domain=e.editor.site.domain,e.info={email:e.editor.site.email,phone:e.editor.site.phone,address:e.editor.site.address},e.setSubDomain=function(){return t.updateSubdomain({id:e.editor.site.id},{subdomain:e.subdomain}).$promise.then(function(){e.editor.site.subdomain=e.subdomain})},e.setDomain=function(){return t.updateDomain({id:e.editor.site.id},{domain:e.editor.site.domain}).$promise.then(function(){e.editor.site.domain=e.domain})},e.updateContact=function(){return t.update({id:e.editor.site.id},e.info).$promise.then(function(){angular.extend(e.editor.site,e.info)})},e.publish=function(){return t.update({id:e.editor.site.id},{is_published:!0}).$promise.then(function(){e.editor.site.is_published=1})}}]),EditorApp.controller("ContentPostsCtrl",["$scope","PageResource",function(e,o){e.posts=o.posts()}]),EditorApp.controller("ContentFeedsCtrl",["$scope","PageResource",function(e,o){e.feeds=o.feeds()}]),EditorApp.controller("ContentAlbumsCtrl",["$scope","PageResource",function(e,o){e.albums=o.albums()}]),EditorApp.controller("ContentPhotosCtrl",["$scope","PageResource",function(e,o){e.photos=o.photos()}]),EditorApp.controller("ContentEventsCtrl",["$scope","PageResource",function(e,o){e.events=o.events()}]);