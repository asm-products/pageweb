<?php

namespace PageWeb\Toolbox;

/**
 * @author Laju Morrison <morrelinko@gmail.com>
 */
class WordBlacklist
{
    protected $transforms = [
        '\*' => '.*',
        '\?' => '.',
        '\[\!' => '[^',
        '\[' => '[',
        '\]' => ']',
        '\.' => '\.',
        '\\' => '\\\\'
    ];

    protected $patterns = [
        'adwords?' => true,
        'css\d*' => true,
        'api\d*' => true,
        'asset[s\d]*' => true,
        's\d*' => true,
        'www\d*' => true,
        'beta\d*' => true,
        'clients?' => true,
        'developers?' => true,
        'networks?' => true,
        'e?mail' => true,
        'discussions?' => true,
        'docs?' => true,
        'statistics?' => true,
        'testers?' => true,
        'stats?' => true,
        'surveys?' => true,
        'videos?' => true,
        'servers?' => true,
        'uploads?' => true,
        'files?' => true,
        'forum?' => true,
        'feeds?' => true,
        'graphs?' => true,
        'images?' => true,
        'https?' => true,
        'investors?' => true,
        'jobs?' => true,
        'logs?' => true,
        'pop\d?' => true,
        'i\d*' => true,
        'cp\d*' => true,
        'img\d*' => true,
        'js\d*' => true,
        'ns\d*' => true,
    ];

    protected $words = [
        'about' => true,
        'aboutus' => true,
        'abuse' => true,
        'acme' => true,
        'ad' => true,
        'admanager' => true,
        'admin' => true,
        'admindashboard' => true,
        'administrator' => true,
        'ads' => true,
        'adsense' => true,
        'adult' => true,
        'adwords' => true,
        'affiliate' => true,
        'affiliatepage' => true,
        'affiliates' => true,
        'afp' => true,
        'analytics' => true,
        'android' => true,
        'answer' => true,
        'answers' => true,
        'ap' => true,
        'api' => true,
        'api1' => true,
        'api2' => true,
        'api3' => true,
        'apis' => true,
        'app' => true,
        'appengine' => true,
        'application' => true,
        'appnews' => true,
        'apps' => true,
        'asdf' => true,
        'asset' => true,
        'assets' => true,
        'assets1' => true,
        'assets2' => true,
        'assets3' => true,
        'assets4' => true,
        'assets5' => true,
        'backup' => true,
        'bank' => true,
        'base' => true,
        'beginners' => true,
        'beta' => true,
        'billing' => true,
        'binaries' => true,
        'binary' => true,
        'biz' => true,
        'blackberry' => true,
        'blog' => true,
        'blogs' => true,
        'blogsearch' => true,
        'book' => true,
        'books' => true,
        'buy' => true,
        'buzz' => true,
        'cache' => true,
        'calendar' => true,
        'cart' => true,
        'catalog' => true,
        'catalogs' => true,
        'chart' => true,
        'charts' => true,
        'chat' => true,
        'checkout' => true,
        'client' => true,
        'clients' => true,
        'clients1' => true,
        'cname' => true,
        'cnarne' => true,
        'code' => true,
        'community' => true,
        'confirm' => true,
        'confirmation' => true,
        'contact' => true,
        'contacts' => true,
        'contactus' => true,
        'contact-us' => true,
        'content' => true,
        'controlpanel' => true,
        'core' => true,
        'corp' => true,
        'countries' => true,
        'country' => true,
        'cpanel' => true,
        'css' => true,
        'css1' => true,
        'css2' => true,
        'css3' => true,
        'cvs' => true,
        'dashboard' => true,
        'data' => true,
        'demo' => true,
        'deploy' => true,
        'deployment' => true,
        'desktop' => true,
        'dev' => true,
        'devel' => true,
        'developer' => true,
        'developers' => true,
        'development' => true,
        'dir' => true,
        'directory' => true,
        'dl' => true,
        'doc' => true,
        'docs' => true,
        'documents' => true,
        'donate' => true,
        'download' => true,
        'downloads' => true,
        'e' => true,
        'earth' => true,
        'email' => true,
        'webmail' => true,
        'enable' => true,
        'encrypted' => true,
        'engine' => true,
        'error' => true,
        'errorlog' => true,
        'errors' => true,
        'features' => true,
        'feed' => true,
        'feedburner' => true,
        'feedproxy' => true,
        'feeds' => true,
        'file' => true,
        'files' => true,
        'finance' => true,
        'folder' => true,
        'folders' => true,
        'forgotpassword' => true,
        'forum' => true,
        'forums' => true,
        'friend' => true,
        'friends' => true,
        'ftp' => true,
        'fuck' => true,
        'fun' => true,
        'fusion' => true,
        'gadget' => true,
        'gears' => true,
        'geographic' => true,
        'gettingstarted' => true,
        'git' => true,
        'gmail' => true,
        'go' => true,
        'goto' => true,
        'gov' => true,
        'graph' => true,
        'graphs' => true,
        'group' => true,
        'groups' => true,
        'help' => true,
        'home' => true,
        'html' => true,
        'htrnl' => true,
        'http' => true,
        'https' => true,
        'i' => true,
        'image' => true,
        'images' => true,
        'img' => true,
        'img1' => true,
        'img2' => true,
        'img3' => true,
        'investor' => true,
        'investors' => true,
        'invoice' => true,
        'invoices' => true,
        'ios' => true,
        'ipad' => true,
        'iphone' => true,
        'irnages' => true,
        'irng' => true,
        'items' => true,
        'join' => true,
        'js' => true,
        'js1' => true,
        'js2' => true,
        'lab' => true,
        'labs' => true,
        'legal' => true,
        'list' => true,
        'lists' => true,
        'local' => true,
        'locale' => true,
        'location' => true,
        'log' => true,
        'login' => true,
        'logs' => true,
        'm' => true,
        'mail' => true,
        'manage' => true,
        'manager' => true,
        'map' => true,
        'maps' => true,
        'marketing' => true,
        'media' => true,
        'message' => true,
        'messages' => true,
        'misc' => true,
        'mms' => true,
        'mobile' => true,
        'model' => true,
        'models' => true,
        'money' => true,
        'movie' => true,
        'movies' => true,
        'my' => true,
        'mystore' => true,
        'net' => true,
        'network' => true,
        'networks' => true,
        'new' => true,
        'news' => true,
        'newsite' => true,
        'ns' => true,
        'ns1' => true,
        'ns2' => true,
        'ns3' => true,
        'ns4' => true,
        'ns5' => true,
        'online' => true,
        'order' => true,
        'org' => true,
        'other' => true,
        'p0rn' => true,
        'pack' => true,
        'page' => true,
        'pages' => true,
        'partner' => true,
        'partnerpage' => true,
        'partners' => true,
        'password' => true,
        'payment' => true,
        'payments' => true,
        'people' => true,
        'person' => true,
        'places' => true,
        'podcasts' => true,
        'pop' => true,
        'pop3' => true,
        'popular' => true,
        'porn' => true,
        'pr0n' => true,
        'pricing' => true,
        'print' => true,
        'private' => true,
        'prod' => true,
        'production' => true,
        'products' => true,
        'profile' => true,
        'profiles' => true,
        'promo' => true,
        'promotions' => true,
        'proxies' => true,
        'proxy' => true,
        'public' => true,
        'purchase' => true,
        'queries' => true,
        'radio' => true,
        'random' => true,
        'reader' => true,
        'recover' => true,
        'redirect' => true,
        'register' => true,
        'registration' => true,
        'release' => true,
        'reports' => true,
        'research' => true,
        'resolve' => true,
        'resolver' => true,
        'rnail' => true,
        'rnicrosoft' => true,
        'rss' => true,
        'sale' => true,
        'sandbox' => true,
        'scholar' => true,
        'search' => true,
        'secure' => true,
        'seminars' => true,
        'server' => true,
        'servers' => true,
        'service' => true,
        'services' => true,
        'shop' => true,
        'shopping' => true,
        'shortcut' => true,
        'shortcuts' => true,
        'signin' => true,
        'signup' => true,
        'sitemap' => true,
        'sitenews' => true,
        'sites' => true,
        'sketchup' => true,
        'sky' => true,
        'slash' => true,
        'slashinvoice' => true,
        'slut' => true,
        'sms' => true,
        'smtp' => true,
        'soap' => true,
        'software' => true,
        'sorry' => true,
        'spreadsheet' => true,
        'spreadsheets' => true,
        'srntp' => true,
        'ssl' => true,
        'stage' => true,
        'staging' => true,
        'static' => true,
        'statistics' => true,
        'stats' => true,
        'status' => true,
        'store' => true,
        'suggest' => true,
        'suggestqueries' => true,
        'support' => true,
        'survey' => true,
        'surveys' => true,
        'surveytool' => true,
        'svn' => true,
        'sync' => true,
        'sysadmins' => true,
        'talk' => true,
        'talkgadget' => true,
        'test' => true,
        'testing' => true,
        'text' => true,
        'tool' => true,
        'toolbar' => true,
        'toolbars' => true,
        'tools' => true,
        'trac' => true,
        'translate' => true,
        'translation' => true,
        'translator' => true,
        'trends' => true,
        'txt' => true,
        'ul' => true,
        'upload' => true,
        'uploads' => true,
        'validation' => true,
        'validations' => true,
        'video' => true,
        'videos' => true,
        'video-stats' => true,
        'voice' => true,
        'w' => true,
        'wave' => true,
        'webdisk' => true,
        'webmaster' => true,
        'webrnail' => true,
        'whm' => true,
        'whois' => true,
        'wifi' => true,
        'wiki' => true,
        'ww' => true,
        'www' => true,
        'www1' => true,
        'www2' => true,
        'wwww' => true,
        'xhtml' => true,
        'xhtrnl' => true,
        'xml' => true,
        'xxx' => true,
    ];

    /**
     * Checks if a string is not blacklisted
     *
     * @param string $str
     * @return bool True if the string is not black listed or false otherwise
     */
    public function check($str)
    {
        if (isset($this->words[$str])) {
            return false;
        }

        $patterns = implode('|', array_keys($this->patterns));

        if (preg_match('#^(' . $patterns . ')$#i', $str)) {
            return false;
        }

        return true;
    }
}
